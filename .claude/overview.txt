  🎨 Color Analysis App - Project Overview

  What it is: A web-based personal color analysis tool that uses MediaPipe face detection to extract skin and eye colors
  from photos, then analyzes them to determine color seasons, undertones, and optimal color palettes.

  Tech Stack: React + TypeScript + Vite + MediaPipe + Tailwind CSS + Zustand

  ---
  📋 Complete Session Summary

  Phase 1: OpenCV → MediaPipe Migration

  - Started with: Broken OpenCV.js setup causing WASM loading errors
  - Problem: OpenCV files couldn't be loaded locally, CORS issues, sync fetch failures
  - Solution: Completely removed OpenCV and switched to MediaPipe Face Mesh
  - Result: Clean, working face detection with CDN-hosted models

  Phase 2: MediaPipe Color Extraction System

  - Built: Comprehensive 3-part color extraction:
    a. Skin Colors: 10 different facial regions (cheeks, forehead, chin, jaw, nose, eye areas)
    b. Eye Colors: 3 regions (inner, outer, iris) from both eyes averaged
    c. Hair Colors: Removed (MediaPipe couldn't detect hair reliably)
  - Technical Features:
    - 7×7 pixel neighborhood sampling around each landmark (49 pixels per point)
    - 468 MediaPipe facial landmarks with specific region targeting
    - Brightness-based sorting (darkest to lightest swatches)
    - Extensive debug logging throughout the pipeline

  Phase 3: Robust Image Processing

  - Fixed: HEIC-converted JPEG compatibility issues
  - Added: Image scaling (max 1024px), high-quality rendering
  - Implemented: Fallback processing (JPEG → PNG conversion)
  - Included: Detailed debug logging for troubleshooting

  Phase 4: Visual Debug System

  - Created: Landmark visualization overlay showing:
    - 🔴 Red dots: Skin sampling points
    - 🔵 Teal dots: Eye sampling points
    - Numbered landmarks with tooltips
    - Interactive legend
  - Purpose: Debug color sampling accuracy and MediaPipe detection

  Phase 5: UI Enhancement

  - Color Swatches Display:
    - 10 skin squares: Left Cheek, Right Cheek, Forehead, Chin, Left Jaw, Right Jaw, Nose Bridge, Nose Base, Left Eye Area,
   Right Eye Area
    - 3 eye squares: Inner, outer, iris regions
    - Square format: 48×48px with white borders and region labels
    - Hover tooltips: Show exact RGB values and region names

  ---
  🏗️ Current Architecture

  Core Files:

  1. ColorAnalysis.tsx - Main component with image upload, MediaPipe integration, analysis flow
  2. mediapipeDetection.ts - Face detection, landmark processing, color extraction
  3. colorAnalysisStore.ts - Zustand store for results and state management
  4. colorAnalysis.ts - Color theory functions (undertone, season determination)

  Data Flow:

  1. Image Upload → Canvas rendering with scaling
  2. MediaPipe Detection → 468 facial landmarks
  3. Color Extraction → 10 skin + 3 eye swatches with 7×7 sampling
  4. Color Analysis → Undertone, season, confidence scoring
  5. UI Display → Visual swatches + landmark overlay + analysis results

  Key Features:

  - ✅ Working MediaPipe integration with comprehensive error handling
  - ✅ 10 skin region sampling from central facial features
  - ✅ 3 eye region sampling with averaging
  - ✅ Visual landmark debugging with color-coded regions
  - ✅ HEIC/JPEG compatibility with fallback processing
  - ✅ Detailed logging throughout the entire pipeline
  - ✅ Clean UI with proper swatch display and region labeling

  ---
  🎯 Current Status

  - MediaPipe face detection: ✅ Working with debug visuals
  - Color extraction: ✅ 10 skin + 3 eye regions with neighborhood sampling
  - Hair analysis: ❌ Completely removed (MediaPipe limitation)
  - UI display: ✅ Color squares with region labels and tooltips
  - Debugging: ✅ Comprehensive logging and visual landmark overlay